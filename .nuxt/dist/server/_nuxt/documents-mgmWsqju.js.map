{"version":3,"file":"documents-mgmWsqju.js","sources":["../../../../stores/documents.ts"],"sourcesContent":["import {defineStore, type PiniaCustomProperties} from \"pinia\";\nimport axios from \"~/composables/axios\";\nimport {toast} from \"vue3-toastify\";\nimport nuxtStorage from \"nuxt-storage/nuxt-storage\";\n\nexport const useDocumentStore = defineStore('document-store', {\n\n  state: () => ({\n    documentList: {},\n    documentItem: {},\n    userList: ref({}),\n    createChainForm: [],\n    showDepartment: [],\n    showUsersNode: [],\n    chainSchedule: {},\n    createForm: {\n      title: '',\n      description: '',\n      file: '',\n      src: '',\n      receiver_id: ''\n    },\n    draggableUser: null,\n    showContext: null,\n    showContextDepartment: null,\n    showWarn: false,\n    showCreateDoc: false,\n    showRejectedWarn: false\n  }),\n  getters: {\n    get_all_document: (state) => state.documentList\n  },\n  actions: {\n    async docSign(params: { id: number, second_password: string | number }): Promise<void> {\n      await axios.patch(`api/v1/document/sign/${params.id}`, {\n        second_password: params.second_password\n      }, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        toast.success('Доступ разрешен', {autoClose: 1000, theme: 'auto'})\n      })\n    },\n    async loadAllDocument(params: { page: number, limit: number, type?: any }): Promise<void> {\n      await axios.get(`api/v1/document/document-list${params.type ? '/' + params.type : ''}`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.documentList = res.data\n      })\n    },\n\n    async loadDocument(params: { id: readonly string[] | number[] }): Promise<void> {\n      await axios.get(`api/v1/document/${params.id}`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.documentItem = res.data\n\n      })\n    },\n\n    async docCreate(params: { title: any, description: any, receiver_id: any, file: any }): Promise<void> {\n      let fd = new FormData()\n      fd.set('title', params.title)\n      fd.set('description', params.description)\n      fd.set('receiver_id', params.receiver_id)\n      if (typeof params.file !== 'string') {\n        fd.set('file', params.file)\n      }\n      await axios.post(`api/v1/document/create`, fd, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        toast.success('Документ создан', {autoClose: 1000, theme: 'auto'})\n        this.loadAllDocument({ page: 1, limit: 10})\n        this.showCreateDoc = false\n      })\n    },\n\n    async docUpdate(params: { title?: any, description?: any, users: any, id: any }): Promise<void> {\n      let fd = new FormData()\n      // fd.set('users', params.users)\n      // fd.set('title', params.title)\n      // fd.set('description', params.description)\n      await axios.patch(`api/v1/document/update/${params.id}`, {\n        title: params.title,\n        description: params.description,\n        users: params.users,\n      }, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        toast.success('Успешный запуск', {autoClose: 1000, theme: 'auto'})\n      })\n    },\n\n    async docDelete(params: { id: any }) {\n      await axios.delete(`api/v1/document/delete/${params.id}`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        toast.success('Успешно удалён', {theme: 'auto', autoClose: 1000})\n\n      })\n    }\n  }\n})"],"names":[],"mappings":"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"}