import{w as i}from"./entry.mbXDUFAE.js";import{a,n,l as r}from"./index.aX4wazua.js";const c=i("current-company",{state:()=>({company:{id:"",name:"",address:"",created_at:"",description:"",email:"",logo_file:"",users_count:"",departments_count:"",objects_count:""},news:{title:"",description:"",photo:"",photo_url:""},department:{id:"",name:"",participants:[]},current_department:{id:"",name:"",participants:[]}}),getters:{current_company(t){return this.company},get_all_company(t){return this.company},get_all_news(t){return this.news},get_all_department(t){return this.department},get_department(t){return this.current_department}},actions:{async loadCurrentCompany(){await a.get("api/v1/company/my-company",{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(t=>{this.company=t.data})},async loadCompanyList(t){await a.get(`api/v1/company/company-list?page=${t.page}&limit=${t.limit}&query=${t.query}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.company=e.data})},async loadCompany(t){await a.get(`api/v1/company/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.company=e.data})},async loadDepartmentList(){await a.get("api/v1/department/department-list",{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(t=>{this.department=t.data})},async loadDepartment(t){await a.get(`api/v1/department/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.current_department=e.data})},async loadNewsList(){await a.get("api/v1/news/news-list",{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(t=>{this.news=t.data})},async loadNews(t){await a.get(`api/v1/news/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.news=e.data})},async createCompany(t){let e=new FormData;e.set("name",t.company.name),e.set("address",t.company.address),e.set("description",t.company.description),e.set("email",t.company.email),typeof t.company.logo_file!="string"&&e.set("logo_file",t.company.logo_file),await a.post("api/v1/company/create",e,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(o=>{this.company=o.data,r.success("Компания успешно создана",{autoClose:1500,theme:"auto"}),this.loadCompanyList({page:1,limit:5,query:""})}).catch(o=>{r.error(o,{autoClose:1500,theme:"auto"})})},async createDepartment(t){await a.post("api/v1/department/create",{name:t.department.name},{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.department=e.data,this.loadDepartmentList()}).catch(e=>{r.error("Ошибка при создании",{theme:"auto",autoClose:1500})})},async deleteDepartment(t,e){await a.delete(`api/v1/department/delete/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(o=>{r.success("Успешно удалён",{autoClose:1500,theme:"auto"}),this.department=o.data,e.go(-1)})}}});export{c as u};
